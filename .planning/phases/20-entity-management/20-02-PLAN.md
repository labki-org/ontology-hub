---
phase: 20-entity-management
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/src/components/entity/forms/CategoryForm.tsx
  - frontend/src/components/entity/forms/PropertyForm.tsx
  - frontend/src/components/entity/forms/SubobjectForm.tsx
  - frontend/src/components/entity/modals/CreateEntityModal.tsx
autonomous: true

must_haves:
  truths:
    - "User can fill required fields for category and see validation errors on blur"
    - "User can fill required fields for property including datatype and cardinality"
    - "User can fill required fields for subobject"
    - "Create button is disabled until form is valid"
  artifacts:
    - path: "frontend/src/components/entity/forms/CategoryForm.tsx"
      provides: "Category creation form with RHF + Zod"
      min_lines: 60
    - path: "frontend/src/components/entity/forms/PropertyForm.tsx"
      provides: "Property creation form with datatype/cardinality selects"
      min_lines: 80
    - path: "frontend/src/components/entity/forms/SubobjectForm.tsx"
      provides: "Subobject creation form"
      min_lines: 50
    - path: "frontend/src/components/entity/modals/CreateEntityModal.tsx"
      provides: "Generic modal wrapper for entity creation"
      min_lines: 40
  key_links:
    - from: "frontend/src/components/entity/forms/CategoryForm.tsx"
      to: "react-hook-form"
      via: "useForm with zodResolver"
      pattern: "useForm.*zodResolver"
    - from: "frontend/src/components/entity/modals/CreateEntityModal.tsx"
      to: "@/components/ui/dialog"
      via: "Dialog primitives"
      pattern: "Dialog.*DialogContent"
---

<objective>
Create the simple entity forms (Category, Property, Subobject) and the generic CreateEntityModal wrapper. These forms have no complex relationship management - just basic fields.

Purpose: Enable creation of the three basic schema entity types. Property form includes datatype/cardinality selection.
Output: CategoryForm.tsx, PropertyForm.tsx, SubobjectForm.tsx, CreateEntityModal.tsx
</objective>

<execution_context>
@/home/daharoni/.claude/get-shit-done/workflows/execute-plan.md
@/home/daharoni/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/20-entity-management/20-CONTEXT.md
@.planning/phases/20-entity-management/20-RESEARCH.md
@frontend/src/components/ui/dialog.tsx
@frontend/src/components/ui/input.tsx
@frontend/src/components/ui/select.tsx
@frontend/src/components/ui/textarea.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CreateEntityModal wrapper component</name>
  <files>
    frontend/src/components/entity/modals/CreateEntityModal.tsx
  </files>
  <action>
Create a generic modal wrapper for entity creation:

1. Props:
   - isOpen: boolean
   - onClose: () => void
   - title: string (e.g., "Create Category")
   - children: React.ReactNode (the form component)

2. Structure using Radix Dialog:
   ```tsx
   <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>
     <DialogContent className="max-w-lg">
       <DialogHeader>
         <DialogTitle>{title}</DialogTitle>
       </DialogHeader>
       <div className="mt-4">
         {/* Required fields legend */}
         <p className="text-sm text-muted-foreground mb-4">
           Fields marked with <span className="text-red-600">*</span> are required
         </p>
         {children}
       </div>
     </DialogContent>
   </Dialog>
   ```

3. Include DialogDescription for accessibility (can be visually hidden).

4. Export as named export.
  </action>
  <verify>
    - CreateEntityModal.tsx exists and uses Dialog from @/components/ui/dialog
    - Has required fields legend with asterisk explanation
    - Props include isOpen, onClose, title, children
  </verify>
  <done>
    - Generic modal wrapper ready for all entity types
    - Accessibility legend for required fields
    - Clean API for form embedding
  </done>
</task>

<task type="auto">
  <name>Task 2: Create CategoryForm and SubobjectForm components</name>
  <files>
    frontend/src/components/entity/forms/CategoryForm.tsx
    frontend/src/components/entity/forms/SubobjectForm.tsx
  </files>
  <action>
**CategoryForm.tsx:**

1. Setup form with useForm + zodResolver:
   ```tsx
   import { useForm } from 'react-hook-form'
   import { zodResolver } from '@hookform/resolvers/zod'
   import { categorySchema, CategoryFormData } from './schemas'

   interface CategoryFormProps {
     onSubmit: (data: CategoryFormData) => void
     onCancel: () => void
     isSubmitting?: boolean
   }

   export function CategoryForm({ onSubmit, onCancel, isSubmitting }: CategoryFormProps) {
     const form = useForm<CategoryFormData>({
       resolver: zodResolver(categorySchema),
       mode: 'onBlur', // Per CONTEXT: validate on blur
       defaultValues: {
         id: '',
         label: '',
         description: '',
         parents: [],
       },
     })

     const isValid = form.formState.isValid
     // ...
   }
   ```

2. Form fields using FormField component (from 20-01):
   - ID: Input with placeholder "category-name" and helper text
   - Label: Input
   - Description: Textarea

3. Buttons at bottom:
   - Cancel (variant="outline", onClick={onCancel})
   - Create (type="submit", disabled={!isValid || isSubmitting})

4. Note: Parents field NOT included yet - handled in Plan 05 with EntityCombobox

**SubobjectForm.tsx:**

Same structure as CategoryForm but using subobjectSchema:
- ID, Label, Description fields only
- Properties relationship handled in Plan 05
  </action>
  <verify>
    - CategoryForm.tsx exports CategoryForm with useForm + zodResolver
    - Form mode is 'onBlur'
    - Create button disabled when !isValid or isSubmitting
    - SubobjectForm.tsx has same structure with subobjectSchema
  </verify>
  <done>
    - CategoryForm validates on blur, disables create until valid
    - SubobjectForm follows same pattern
    - Both ready to be embedded in CreateEntityModal
  </done>
</task>

<task type="auto">
  <name>Task 3: Create PropertyForm with datatype/cardinality selects</name>
  <files>
    frontend/src/components/entity/forms/PropertyForm.tsx
  </files>
  <action>
Create PropertyForm.tsx with additional select fields:

1. Same base setup as CategoryForm but with propertySchema

2. Datatype select options (from ontology domain):
   ```tsx
   const DATATYPE_OPTIONS = [
     { value: 'text', label: 'Text' },
     { value: 'number', label: 'Number' },
     { value: 'date', label: 'Date' },
     { value: 'datetime', label: 'Date/Time' },
     { value: 'boolean', label: 'Boolean' },
     { value: 'page', label: 'Page' },
     { value: 'url', label: 'URL' },
     { value: 'email', label: 'Email' },
     { value: 'telephone', label: 'Telephone' },
   ]
   ```

3. Cardinality select options:
   ```tsx
   const CARDINALITY_OPTIONS = [
     { value: 'single', label: 'Single value' },
     { value: 'multiple', label: 'Multiple values' },
   ]
   ```

4. Use Controller with Radix Select for datatype and cardinality:
   ```tsx
   <Controller
     name="datatype"
     control={form.control}
     render={({ field }) => (
       <Select onValueChange={field.onChange} value={field.value}>
         <SelectTrigger>
           <SelectValue placeholder="Select datatype" />
         </SelectTrigger>
         <SelectContent>
           {DATATYPE_OPTIONS.map(opt => (
             <SelectItem key={opt.value} value={opt.value}>
               {opt.label}
             </SelectItem>
           ))}
         </SelectContent>
       </Select>
     )}
   />
   ```

5. Field order: ID, Label, Description, Datatype, Cardinality
  </action>
  <verify>
    - PropertyForm.tsx uses propertySchema with zodResolver
    - Datatype field renders as Select with at least 5 options
    - Cardinality field renders as Select with single/multiple options
    - Both selects wrapped in Controller for RHF integration
  </verify>
  <done>
    - PropertyForm includes all required fields
    - Select components properly integrated with react-hook-form
    - Validation enforces required datatype and cardinality
  </done>
</task>

</tasks>

<verification>
1. Run `cd /home/daharoni/dev/ontology-hub/frontend && npm run build` - should pass
2. Verify all 3 form components export their respective forms
3. Verify CreateEntityModal uses Dialog from ui/dialog
4. Verify PropertyForm has Select for datatype and cardinality
</verification>

<success_criteria>
- CreateEntityModal provides clean wrapper with required fields legend
- CategoryForm validates on blur with proper error display
- PropertyForm includes datatype/cardinality selection
- SubobjectForm follows same pattern as CategoryForm
- All forms disable Create button until valid
</success_criteria>

<output>
After completion, create `.planning/phases/20-entity-management/20-02-SUMMARY.md`
</output>

---
phase: 14-validation-workflow-pr
plan: 07
type: execute
wave: 4
depends_on: ["14-06"]
files_modified:
  - frontend/src/components/draft/DraftBannerV2.tsx
  - frontend/src/components/draft/FloatingActionBar.tsx
  - frontend/src/components/draft/ValidationSummaryV2.tsx
autonomous: true

must_haves:
  truths:
    - "Draft banner shows title, status badge, validate button, and submit PR button"
    - "Submit PR button is disabled until draft status is validated"
    - "Floating action bar provides sticky access to validate/submit buttons"
    - "Validation summary displays errors, warnings, and info with entity_key references"
  artifacts:
    - path: "frontend/src/components/draft/DraftBannerV2.tsx"
      provides: "Updated draft banner for v2 workflow"
      exports: ["DraftBannerV2"]
    - path: "frontend/src/components/draft/FloatingActionBar.tsx"
      provides: "Sticky floating action bar"
      exports: ["FloatingActionBar"]
    - path: "frontend/src/components/draft/ValidationSummaryV2.tsx"
      provides: "Validation results display"
      exports: ["ValidationSummaryV2"]
  key_links:
    - from: "frontend/src/components/draft/DraftBannerV2.tsx"
      to: "frontend/src/api/draftApiV2.ts"
      via: "useValidateDraft hook"
      pattern: "useValidateDraft"
    - from: "frontend/src/components/draft/FloatingActionBar.tsx"
      to: "frontend/src/stores/draftStoreV2.ts"
      via: "useDraftStoreV2 for state"
      pattern: "useDraftStoreV2"
---

<objective>
Create v2 draft banner, floating action bar, and validation summary components.

Purpose: The draft UI needs updated components that reflect the v2 workflow (Draft -> Validated -> Submitted -> Merged). The banner shows status and actions. The floating action bar provides sticky access. The validation summary shows structured results.

Output: Three React components for draft workflow UI.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-validation-workflow-pr/14-CONTEXT.md
@.planning/phases/14-validation-workflow-pr/14-RESEARCH.md

# Prior plan summaries
@.planning/phases/14-validation-workflow-pr/14-06-SUMMARY.md

# Existing components (adapt patterns)
@frontend/src/components/draft/DraftBanner.tsx
@frontend/src/components/draft/ValidationSummary.tsx
@frontend/src/components/draft/ValidationBadge.tsx

# API and state
# frontend/src/api/draftApiV2.ts (from 14-06)
# frontend/src/stores/draftStoreV2.ts (from 14-06)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DraftBannerV2 and FloatingActionBar</name>
  <files>
    frontend/src/components/draft/DraftBannerV2.tsx
    frontend/src/components/draft/FloatingActionBar.tsx
  </files>
  <action>
1. DraftBannerV2.tsx - Updated banner for v2 workflow:

Props:
- draft: DraftV2 (from draftApiV2.ts)
- onValidate: () => void
- onSubmitPR: () => void
- onExit: () => void
- isValidating?: boolean
- validationReport?: ValidationReportV2 | null

Layout:
- Left side: AlertCircle icon + "Draft: {title or id}" + Status badge
  - Status badge colors:
    - draft: outline (default)
    - validated: green bg
    - submitted: blue bg
    - merged: purple bg
    - rejected: red bg
- Right side:
  - Validate button: Show when status is "draft", disabled while validating, shows spinner when isValidating
  - Submit PR button: Enabled only when status is "validated", triggers onSubmitPR (opens wizard)
  - Exit button: X icon, calls onExit
- Below banner (collapsible): If validationReport exists, show ValidationSummaryV2

Use lucide-react icons: AlertCircle, CheckCircle, GitPullRequest, X, Loader2
Use shadcn Badge, Button components.

2. FloatingActionBar.tsx - Sticky bottom bar:

Props:
- draft: DraftV2
- onValidate: () => void
- onSubmitPR: () => void
- isValidating?: boolean

Layout:
- Fixed bottom center position: "fixed bottom-4 left-1/2 -translate-x-1/2 z-50"
- Card container with shadow-lg
- Contents:
  - Status badge (same coloring as DraftBannerV2)
  - Validate button (disabled when not "draft" status or while validating)
  - Submit PR button (disabled when not "validated" status)
  - Separator between status and buttons

Only render when draft context is active (draft prop is not null).
  </action>
  <verify>cd /home/daharoni/dev/ontology-hub/frontend && npx tsc --noEmit --skipLibCheck src/components/draft/DraftBannerV2.tsx src/components/draft/FloatingActionBar.tsx 2>&1 | head -20</verify>
  <done>DraftBannerV2 and FloatingActionBar components exist with proper status-aware button states</done>
</task>

<task type="auto">
  <name>Task 2: Create ValidationSummaryV2</name>
  <files>frontend/src/components/draft/ValidationSummaryV2.tsx</files>
  <action>
Create validation results display component:

Props:
- report: ValidationReportV2
- onEntityClick?: (entityType: string, entityKey: string) => void

Layout:
- Header: "Validation Results" with pass/fail indicator
  - Pass: green CheckCircle + "Validation passed"
  - Fail: red XCircle + "Validation failed ({N} errors)"
- Summary stats: "{N} errors, {M} warnings, {K} info" with colored counts
- Semver suggestion: "Suggested version bump: {major|minor|patch}" badge
- Three collapsible sections (only show if items exist):
  1. Errors section (red): Each error shows:
     - entity_key as clickable link (if onEntityClick provided)
     - code in monospace badge
     - message text
     - field_path if present
  2. Warnings section (amber/yellow): Same format
  3. Info section (blue): Same format
- Module/bundle suggestions section (if any):
  - List of module_key -> suggested version

Use AccordionSection pattern from Phase 13 for collapsible sections.
Use shadcn Badge for severity indicators.
Use lucide-react icons: CheckCircle, XCircle, AlertTriangle, Info.

Each validation item should be a row with:
- Severity icon (red circle for error, yellow triangle for warning, blue circle for info)
- Entity type + entity_key as clickable text (bold)
- Code badge (outline, monospace)
- Message text
- Optional field_path in gray
  </action>
  <verify>cd /home/daharoni/dev/ontology-hub/frontend && npx tsc --noEmit --skipLibCheck src/components/draft/ValidationSummaryV2.tsx 2>&1 | head -20</verify>
  <done>ValidationSummaryV2 component exists with structured display of errors, warnings, and info</done>
</task>

</tasks>

<verification>
- All three components compile without TypeScript errors
- DraftBannerV2 shows correct button states based on draft status
- FloatingActionBar renders at fixed bottom position
- ValidationSummaryV2 displays grouped validation results
</verification>

<success_criteria>
- Banner shows title, status badge, validate and submit buttons
- Submit PR button disabled unless status is "validated"
- Floating action bar provides sticky access to actions
- Validation summary groups results by severity with entity_key links
- Semver suggestion displayed prominently
</success_criteria>

<output>
After completion, create `.planning/phases/14-validation-workflow-pr/14-07-SUMMARY.md`
</output>

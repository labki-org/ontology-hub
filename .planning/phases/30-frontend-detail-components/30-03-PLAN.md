---
phase: 30-frontend-detail-components
plan: 03
type: execute
wave: 2
depends_on: ["30-01"]
files_modified:
  - frontend/src/components/layout/Sidebar.tsx
autonomous: true

must_haves:
  truths:
    - "Sidebar shows Artifacts section with Dashboards, Resources, Templates"
    - "User can see dashboard list in sidebar"
    - "User can see resource list in sidebar"
    - "Clicking dashboard/resource in sidebar selects it for detail view"
  artifacts:
    - path: "frontend/src/components/layout/Sidebar.tsx"
      provides: "Artifacts section with Dashboard, Resource, Template EntitySections"
      contains: "Artifacts"
  key_links:
    - from: "Sidebar.tsx"
      to: "useDashboards and useResources hooks"
      via: "import and call"
      pattern: "use(Dashboards|Resources)\\("
    - from: "Sidebar.tsx EntitySection"
      to: "graphStore setSelectedEntity"
      via: "entityType prop"
      pattern: "entityType=\"dashboard\"|entityType=\"resource\""
---

<objective>
Update Sidebar to add Artifacts section grouping Dashboards, Resources, and Templates together.

Purpose: Per CONTEXT.md decision, artifact types (Dashboards, Resources, Templates) should be grouped in their own section. This enables users to browse and select dashboards/resources from the sidebar.

Output: Modified Sidebar.tsx with new Artifacts section, data fetching for dashboards/resources, and EntitySection components for each.
</objective>

<execution_context>
@/home/daharoni/.claude/get-shit-done/workflows/execute-plan.md
@/home/daharoni/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/30-frontend-detail-components/30-CONTEXT.md
@.planning/phases/30-frontend-detail-components/30-RESEARCH.md
@.planning/phases/30-frontend-detail-components/30-01-SUMMARY.md

# Key source file
@frontend/src/components/layout/Sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Dashboard and Resource data fetching to Sidebar</name>
  <files>frontend/src/components/layout/Sidebar.tsx</files>
  <action>
Update Sidebar.tsx to fetch dashboards and resources data.

1. Add imports for new hooks:
```tsx
import {
  useCategories,
  useProperties,
  useSubobjects,
  useModules,
  useBundles,
  useTemplates,
  useDashboards,    // ADD
  useResources,     // ADD
  useOntologyVersion,
} from '@/api/entities'
```

2. Add imports for new icons (lucide-react):
```tsx
import { ..., LayoutDashboard, FileText } from 'lucide-react'
```
Note: FileText may already be imported. LayoutDashboard is the icon for dashboards.

3. Add data fetching in the Sidebar component body (after templates fetch):
```tsx
const { data: dashboardsData, isLoading: dashboardsLoading } = useDashboards(
  undefined,
  undefined,
  draftId
)
const { data: resourcesData, isLoading: resourcesLoading } = useResources(
  undefined,
  undefined,
  draftId
)
```

4. Add data extraction (after templates):
```tsx
const dashboards = dashboardsData?.items || []
const resources = resourcesData?.items || []
```
  </action>
  <verify>
```bash
grep -E "useDashboards|useResources" frontend/src/components/layout/Sidebar.tsx
```
  </verify>
  <done>
Sidebar fetches dashboards and resources data using new hooks.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update EntitySection type and add Artifacts section</name>
  <files>frontend/src/components/layout/Sidebar.tsx</files>
  <action>
1. Update EntitySectionProps entityType union to include new types:
```tsx
entityType: 'category' | 'property' | 'subobject' | 'template' | 'module' | 'bundle' | 'dashboard' | 'resource'
```

2. Update handleDelete function signature to include new types:
```tsx
const handleDelete = async (
  entityType: 'category' | 'property' | 'subobject' | 'template' | 'module' | 'bundle' | 'dashboard' | 'resource',
  ...
)
```

3. Restructure the nav section to create Artifacts group:

REMOVE the standalone Templates section (lines ~522-537).

ADD new Artifacts section AFTER the Modules group (after the `<div className="h-px bg-border my-2" />`):

```tsx
{/* Artifacts group */}
<div className="mb-2">
  <div className="px-2 py-1 text-xs font-semibold text-muted-foreground uppercase tracking-wide">
    Artifacts
  </div>
  <EntitySection
    title="Dashboards"
    icon={LayoutDashboard}
    entities={dashboards}
    isLoading={dashboardsLoading}
    searchTerm={debouncedSearchTerm}
    entityType="dashboard"
    isDraftMode={isDraftMode}
    onAddNew={() => openCreateModal('dashboard')}
    onDelete={(key, label) => handleDelete('dashboard', key, label)}
    onUndoDelete={handleUndoDelete}
    deletedEntityChanges={deletedEntityChanges}
  />
  <EntitySection
    title="Resources"
    icon={FileText}
    entities={resources}
    isLoading={resourcesLoading}
    searchTerm={debouncedSearchTerm}
    entityType="resource"
    isDraftMode={isDraftMode}
    onAddNew={() => openCreateModal('resource')}
    onDelete={(key, label) => handleDelete('resource', key, label)}
    onUndoDelete={handleUndoDelete}
    deletedEntityChanges={deletedEntityChanges}
  />
  <EntitySection
    title="Templates"
    icon={FileCode}
    entities={templates}
    isLoading={templatesLoading}
    searchTerm={debouncedSearchTerm}
    entityType="template"
    isDraftMode={isDraftMode}
    onAddNew={() => openCreateModal('template')}
    onDelete={(key, label) => handleDelete('template', key, label)}
    onUndoDelete={handleUndoDelete}
    deletedEntityChanges={deletedEntityChanges}
  />
</div>
```

Note: Create forms don't exist yet (Phase 31), but we include onAddNew callbacks. They'll open the create modal which will need to be extended in Phase 31.
  </action>
  <verify>
```bash
grep -E "Artifacts|entityType=\"dashboard\"|entityType=\"resource\"" frontend/src/components/layout/Sidebar.tsx
cd frontend && npx tsc --noEmit
```
  </verify>
  <done>
Sidebar has Artifacts section containing Dashboards, Resources, and Templates EntitySections. TypeScript compiles.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update draftStore openCreateModal type</name>
  <files>frontend/src/stores/draftStore.ts</files>
  <action>
The draftStore's openCreateModal function takes an entityType parameter. We need to extend its type to include 'dashboard' and 'resource'.

Find the type definition for createModalEntityType and update it:

FROM:
```tsx
createModalEntityType: 'category' | 'property' | 'subobject' | 'template' | 'module' | 'bundle' | null
```

TO:
```tsx
createModalEntityType: 'category' | 'property' | 'subobject' | 'template' | 'module' | 'bundle' | 'dashboard' | 'resource' | null
```

Also update openCreateModal parameter type and openNestedCreateModal entityType to match.

This allows clicking "+ New" on Dashboards/Resources sections (actual form implementation in Phase 31).
  </action>
  <verify>
```bash
grep -E "'dashboard'|'resource'" frontend/src/stores/draftStore.ts
cd frontend && npx tsc --noEmit
```
  </verify>
  <done>
draftStore types updated to include 'dashboard' and 'resource' entity types.
  </done>
</task>

</tasks>

<verification>
1. Sidebar shows "Artifacts" section header
2. Dashboards, Resources, and Templates listed under Artifacts
3. EntitySections have correct entityType values
4. Data fetching hooks called for dashboards and resources
5. TypeScript compiles without errors
6. Clicking dashboard/resource in sidebar navigates to detail (relies on Plan 02 registration)
</verification>

<success_criteria>
- Artifacts section visible in sidebar with Dashboards, Resources, Templates
- Dashboard list shows with LayoutDashboard icon
- Resource list shows with FileText icon
- Templates moved from standalone section into Artifacts group
- TypeScript compiles successfully
</success_criteria>

<output>
After completion, create `.planning/phases/30-frontend-detail-components/30-03-SUMMARY.md`
</output>

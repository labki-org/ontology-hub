# Milestone v1.1.0: Dashboard & Resource Entities

**Status:** ✅ SHIPPED 2026-01-28
**Phases:** 23-32
**Total Plans:** 22

## Overview

Added Dashboard and Resource as first-class entity types with full CRUD, graph visualization, and transitive module derivation chain. Dashboards provide documentation pages with wikitext content, while Resources represent pre-filled category content with dynamic fields.

## Phases

### Phase 23: Ontology Schema Updates ✓

**Goal**: Define JSON schemas and repo structure for Dashboard and Resource entities in labki-ontology
**Depends on**: None (first phase of v1.1.0)
**Plans**: 1 plan

Plans:
- [x] 23-01: Fix entity-index, update dashboard/properties schemas, verify validation

**Details:**
- Dashboard JSON schema with pages array validation
- Resource JSON schema with additionalProperties:true
- Property Allows_value_from_category field for category-based allowed values
- Page name pattern uses regex alternation for optional patterns

### Phase 24: Database Schema ✓

**Goal**: Add tables for Dashboard and Resource entities
**Depends on**: Phase 23
**Plans**: 2 plans

Plans:
- [x] 24-01: Create Dashboard/Resource models, junction tables, enum updates
- [x] 24-02: Alembic migration and database verification

**Details:**
- Dashboard table with pages JSONB column
- Resource table with category_key (plain string, not FK)
- Junction tables: module_dashboard, bundle_dashboard
- ondelete CASCADE for parent-side FK, RESTRICT for dashboard FK

### Phase 25: Backend Ingest Pipeline ✓

**Goal**: Parse and ingest Dashboard and Resource entities from repo
**Depends on**: Phase 24
**Plans**: 2 plans

Plans:
- [x] 25-01: Extend EntityParser with parse_dashboard, parse_resource methods
- [x] 25-02: Update ingest pipeline (github.py, ingest.py) for new entities

**Details:**
- Resources use nested paths like templates (resources/Category/key.json)
- Dashboard relationships resolved via lookup table pattern

### Phase 26: Backend API Endpoints ✓

**Goal**: List and detail endpoints for new entities
**Depends on**: Phase 25
**Plans**: 1 plan

Plans:
- [x] 26-01: Add response schemas and 5 endpoints for Dashboard/Resource

**Details:**
- GET /dashboards, GET /dashboards/{key}
- GET /resources, GET /resources/{key:path}
- GET /categories/{key}/resources
- Dynamic properties extraction uses reserved_keys blacklist

### Phase 27: Module Auto-Derivation Extension ✓

**Goal**: Extend derivation to include categories from allowed_values and resources from categories
**Depends on**: Phase 26
**Plans**: 2 plans

Plans:
- [x] 27-01: Implement transitive derivation algorithm in module_derived.py
- [x] 27-02: Integrate with draft system and add unit tests

**Details:**
- Transitive chains until no new categories or max_depth (10)
- Check both Allows_value_from_category and allowed_values.from_category formats
- Include draft-created resources via category field check
- Use "add" op for derived paths per CLAUDE.md

### Phase 28: Draft CRUD Support ✓

**Goal**: Create/update/delete dashboards and resources in drafts
**Depends on**: Phase 27
**Plans**: 3 plans

Plans:
- [x] 28-01: Entity type registration and dashboard validation
- [x] 28-02: Resource field validation against category properties
- [x] 28-03: Integration tests for dashboard and resource CRUD

**Details:**
- Dashboard CREATE requires root page (name: '')
- Resource RESERVED_KEYS: id, label, description, category, entity_key, source_path
- Draft-created categories bypass materialized view for property lookup

### Phase 29: Frontend Graph Visualization ✓

**Goal**: Render Dashboard and Resource nodes in graph view
**Depends on**: Phase 28
**Plans**: 3 plans

Plans:
- [x] 29-01: Backend graph query extension for Dashboard/Resource
- [x] 29-02: Frontend node shapes, colors, and edge styling
- [x] 29-03: Edge type filtering in GraphControls

**Details:**
- Dashboard node: 70px, red-300, rounded rect (r=12)
- Resource node: 45px (compact), cyan-300, small rect (r=4)
- Edge types: module_dashboard (red, long dash), category_resource (cyan, short dash)

### Phase 30: Frontend Detail Components ✓

**Goal**: Entity detail pages for viewing/editing dashboards and resources
**Depends on**: Phase 29
**Plans**: 3 plans

Plans:
- [x] 30-01: Add Dashboard and Resource API hooks
- [x] 30-02: Create DashboardDetail and ResourceDetail components
- [x] 30-03: Add Artifacts section to Sidebar

**Details:**
- Dashboard pages in single-item Radix accordion
- Resource category is clickable link to category detail
- Dynamic fields displayed with formatValue helper

### Phase 31: Frontend Create/Edit Forms ✓

**Goal**: Forms for creating new dashboards and resources
**Depends on**: Phase 30
**Plans**: 2 plans

Plans:
- [x] 31-01: Add dashboard schema and create DashboardForm with page management
- [x] 31-02: Add resource schema, create ResourceForm, integrate forms into Sidebar

**Details:**
- Root page uses empty string name (matching backend validation)
- Dynamic fields fetched from category's properties array
- Single-select category using EntityCombobox

### Phase 32: Integration Testing ✓

**Goal**: Verify end-to-end functionality
**Depends on**: Phase 31
**Plans**: 2 plans

Plans:
- [x] 32-01: PR builder extension and file structure tests
- [x] 32-02: E2E derivation chain test and regression verification

**Details:**
- Resources use flattened paths in PR output (resources/{key}.json)
- E2E tests use draft-created categories to bypass materialized view

---

## Milestone Summary

**Decimal Phases:** None (sequential phases 23-32)

**Key Decisions:**
- Resource.category_key stored as plain string (not FK) for ingest flexibility
- Dashboard pages in accordion UI with single item open at a time
- Transitive derivation max_depth of 10 prevents infinite loops
- Use "add" op for derived arrays per CLAUDE.md JSON Patch guidance
- Reserved keys blacklist for dynamic resource field extraction

**Issues Resolved:**
- Category property lookup via materialized view (bypassed for draft-created categories in tests)
- Resource path handling (flattened for PR builder output)

**Issues Deferred:** None

**Technical Debt Incurred:** None

---

*For current project status, see .planning/ROADMAP.md*
